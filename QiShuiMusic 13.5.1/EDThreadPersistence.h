@interface EDThreadPersistence : NSObject
@property (nonatomic) EDMessagePersistence messagePersistence;
@property (nonatomic) EDPersistenceDatabase database;
@property (nonatomic) EDPersistenceHookRegistry hookRegistry;
@property (nonatomic) <EMVIPManager> vipManager;
@property (nonatomic) EMBlockedSenderManager blockedSenderManager;
@property (nonatomic) EDThreadScopeManager threadScopeManager;
@property (nonatomic) <EFScheduler> consistencyCheckScheduler;
@property (nonatomic) <EFScheduler> threadRecomputationScheduler;
@property (nonatomic) EFDebouncer threadRecomputationDebouncer;
@property (nonatomic) Q hash;
@property (nonatomic) # superclass;
@property (nonatomic) NSString description;
@property (nonatomic) NSString debugDescription;
@property (nonatomic) Q signpostID;
- (id)_messageThreadExpressionForThreadObjectID:;
- (void)persistenceIsAddingMailboxWithDatabaseID:objectID:generationWindow:;
- (void)persistenceIsChangingConversationID:messages:generationWindow:;
- (id)_persistenceIsChangingFlags:wrappedMessages:threadObjectID:threadScopeDatabaseID:;
- (id)nextExistingThreadObjectIDForThreadObjectID:forSortDescriptors:excluding:;
- (id)_wrappedMessagesByThreadScopeForPersistedMessages:messageFilter:;
- (id)_messageMailboxesExpressionForMailboxType:;
- (id)_recipientAddressesExpressionForRecipientType:messages:;
- (unsigned long long)signpostID;
- (BOOL)_enumerateThreadObjectIDsForThreadScope:filterClause:sortDescriptors:batchBlock:;
- (void)_addKeyPathsForBasicPropertiesChangeToKeyPaths:;
- (void)persistenceDidAddAddresses:toSender:generation:;
- (id)threadRecomputationDebouncer;
- (BOOL)_updateNewestReadMessageWithWrappedMessage:threadExpression:;
- (BOOL)_deleteMailboxesFromWrappedMessages:fromThreadWithDatabaseID:messageThreadExpression:;
- (void)setThreadRecomputationDebouncer:;
- (id)_messageIsNotDeletedExpression;
- (BOOL)_addThreadScopeToDatabaseWithMailboxType:filterPredicate:needsUpdate:lastViewedDate:connection:;
- (id)_messageThreadExpressionForThreadScope:objectIDs:;
- (void)_addPersistedMessages:journaled:generationWindow:;
- (id)_comparisonExpressionForSortDescriptors:conversationID:threadExpression:threadScopeDatabaseID:connection:;
- (void)_iterateWrappedMessagesByConversationForPersistedMessages:block:;
- (id)_statementForOldestThreadInMailbox:threadScope:createMailboxDatabaseIDIfNecessary:;
- (id)vipManager;
- (void)verifyConsistencyOfThreadScope:;
- (void)persistenceDidDeleteAllMessagesInMailboxesWithURLs:generationWindow:;
- (id)_columnForSortDescriptor:;
- (id)_sendersFromMessagesForThreadObjectID:;
- (id)_threadForWrappedMessages:objectID:;
- (id)_threadDatabaseIDExpressionForThreadScopeDatabaseID:conversation:;
- (id)threadScopeManager;
- (id)_threadQueryForThreadScope:;
- (id)_countMessagesForExpression:;
- (BOOL)addThreads:;
- (id)_addressesFromSelectStatement:additionalRowHandling:;
- (id)_threadScopedToResetForActivatedAccount:;
- (void)_scheduleRecomputationForThread:reason:;
- (void)setThreadRecomputationScheduler:;
- (id)changeForThreadWithObjectID:changedKeyPaths:;
- (id)threadRecomputationScheduler;
- (void)_writeThreadedMessages:withChangedKeyPaths:journaled:generationWindow:;
- (void)persistenceIsChangingFlags:messages:generationWindow:;
- (void)_persistenceIsChangingFlags:messages:generationWindow:;
- (void)persistenceDidAddMessages:generationWindow:;
- (id)_recipientsOfType:fromMessagesForThreadObjectID:;
- (void)_getIndividualMailboxScopes:unifiedMailboxThreadScopes:forAccount:;
- (BOOL)beginMigratingThreadScope:;
- (id)_messageFilterExpressionForFilterPredicate:;
- (long long)_databaseIDForThreadObjectID:;
- (id)threadObjectIDsByNextExistingForThreadObjectIDs:forSortDescriptors:excluding:;
- (void)persistenceDidChangeGlobalMessageID:orConversationID:message:generationWindow:;
- (id)_nonJournaledSubjectForThreadWithObjectID:connection:;
- (id)threadScopeMatcherForActivatedAccount:;
- (void)persistenceDidRemoveAddresses:fromSender:generation:;
- (id)_flagColorsFromRow:;
- (id)consistencyCheckScheduler;
- (BOOL)_addThreadScopeToDatabase:withMailboxDatabaseID:filterPredicate:needsUpdate:lastViewedDate:updateThreadScopeManager:connection:;
- (void)persistenceDidUpdateFollowUpForMessages:generationWindow:;
- (void)persistenceIsUpdatingDisplayDateForMessage:fromDate:generation:;
- (BOOL)_isThreadScopePrecomputed:shouldMigrate:;
- (id)blockedSenderManager;
- (void)threadScopeManager:gatherStatisticsForThreadScopesWithDatabaseIDs:block:;
- (id)_updateThreadForDeleteWithObjectID:threadScopeDatabaseID:generationWindow:;
- (void)persistenceIsAddingMessages:journaled:generationWindow:;
- (BOOL)_deleteRecipientsOfType:fromThreadWithDatabaseID:messageThreadExpression:;
- (id)threadForObjectID:originatingQuery:error:;
- (id)_expressionForThreadScope:;
- (void)persistenceDidChangeReadLaterDate:messages:changeIsRemote:generationWindow:;
- (void)persistenceDidChangeFlags:messages:generationWindow:;
- (void)resetThreadScopesForMailboxScope:;
- (id)_senderAddressesExpressionForMessages:;
- (void)_addKeyPathsForDisplayMessageChangeToKeyPaths:;
- (id)_wrappedMessageForPersistedMessages:threadScope:messageFilter:;
- (id)_threadExpressionForThreadScopeDatabaseID:conversation:;
- (BOOL)_messagesAreJournaledForThreadWithObjectID:;
- (void)resetThreadScopedForActivatedAccount:;
- (void)persistenceDidDeleteMessages:generationWindow:;
- (BOOL)threadScopeManager:mailboxScopeExists:;
- (id)_messageActiveFollowUpExpressionForSentMailboxObjectIDs:;
- (id)_messageMailboxesExpressionForMailboxObjectIDs:;
- (void)_reportSenderBucketChangeForThreadsWithSenderAddresses:generation:;
- (void)persistenceDidUpdateDisplayDateForMessages:changeIsRemote:generation:;
- (id)_addressesFromMessageAddressesStatement:;
- (BOOL)deleteThreadsWithObjectIDs:;
- (id)_updateBasicPropertiesAfterDeleteForThreadObjectID:threadScopeDatabaseID:;
- (BOOL)threadScopeManager:isValidMailboxObjectID:;
- (void).cxx_destruct;
- (void)threadScopeManager:populateThreadScopesWithBlock:;
- (void)persistenceIsDeletingAllMessagesInMailboxWithURL:generationWindow:;
- (id)oldestThreadObjectIDForMailbox:threadScope:;
- (id)_mailboxesForThreadDatabaseID:;
- (void)_persistenceIsDeletingMessages:generationWindow:;
- (id)_recalculateDisplayMessageForThreadObjectID:threadScopeDatabaseID:;
- (void)_resetThreadScope:withDatabaseID:;
- (id)hookRegistry;
- (id)_upsertForThreadsWithThreadScopeDatabaseID:conversation:;
- (void)_enumerateThreadScopesUsingBlock:;
- (id)_mailboxScopeForThreadScope:andFilterPredicate:;
- (id)_messageMailboxesExpressionForMailboxScope:;
- (id)_recipientsOfType:forThreadDatabaseID:;
- (id)threadScopesByDatabaseID;
- (void)_recomputeThreads;
- (id)initWithMessagePersistence:database:hookRegistry:vipManager:blockedSenderManager:;
- (id)statisticsForThreadScopesWithDatabaseIDs:;
- (BOOL)_deleteSendersFromThreadWithDatabaseID:messageThreadExpression:;
- (void)updateLastViewedDateForThreadScope:;
- (void)persistenceDidUpdateProperties:message:generationWindow:;
- (id)_deleteWrappedMessages:fromThreadWithObjectID:threadScopeDatabaseID:generationWindow:;
- (id)_messageThreadExpressionForThreadScope:conversationExpression:;
- (id)_mailboxDatabaseIDsForWrappedMessages:;
- (id)database;
- (BOOL)setPriorityForDisplayMessageSenderForThreadObjectID:;
- (BOOL)threadScopeManager:evictThreadScopesWithDatabaseIDs:completionBlock:;
- (void)persistenceIsInitializingDatabaseWithConnection:;
- (id)_addedMailboxObjectIDsForActivatedAccount:;
- (void)_addOrderByToThreadSelect:forSortDescriptors:;
- (unsigned long long)persistenceStateForThreadScope:;
- (id)_sendersForThreadDatabaseID:senderBucket:;
- (void)persistenceIsDeletingMessages:generationWindow:;
- (void)threadObjectIDsForThreadScope:sortDescriptors:initialBatchSize:journaledObjectIDs:batchBlock:;
- (BOOL)_addThreadScopeToDatabase:needsUpdate:lastViewedDate:updateThreadScopeManager:;
- (id)_persistedMessagesByPossibleThreadScopeForPersistedMessages:;
- (BOOL)_recalculateNewestReadMessageForThreadObjectID:threadScopeDatabaseID:;
- (void)test_tearDown;
- (BOOL)addThreadScopeToDatabase:needsUpdate:lastViewedDate:;
- (void)persistenceDidChangeSenderBucketForSender:generation:;
- (id)_inactiveMailboxDatabaseIDsForMailboxScope:forThreadScopeDatabaseID:;
- (id)_persistedMessagesForMailboxScope:messageExpression:;
- (void)setNeedsUpdateForThreadScope:;
- (id)messagePersistence;
- (id)_filteredPersistedMessagesForPersistedMessages:;
- (id)resetThreadScopesForDeactivatedAccount:;
- (void)_iterateWrappedMessagesByConversationForPersistedMessages:messageFilter:writeBlock:;
- (BOOL)endMigratingThreadScope:;
+ (id)log;
+ (id)signpostLog;
+ (id)tablesAndForeignKeysToResolve:associationsToResolve:;
+ (id)threadSendersTableSchema;
+ (id)threadRecipientsTableSchema;
+ (id)threadScopesTableSchema;
+ (id)threadsTableSchema;
+ (id)threadMailboxesTableSchema;
@end
