@interface MFMailMessageLibrary : NSObject
@property (nonatomic) EDSearchableIndexScheduler searchableIndexScheduler;
@property (nonatomic) EDMessageQueryParser queryParser;
@property (nonatomic) <EFScheduler> fileRemovalAfterCompactionScheduler;
@property (nonatomic) NSMutableDictionary currentAddedMessagesMap;
@property (nonatomic) MFMessageBodyMigrator bodyMigrator;
@property (nonatomic) <EFCancelable> stateCaptureCancelable;
@property (nonatomic) EDWebContentParser remoteContentParser;
@property (nonatomic) NSCache messagesParsedCache;
@property (nonatomic) EDPersistenceHookRegistry hookRegistry;
@property (nonatomic) MFMessageAttachmentMigrator attachmentMigrator;
@property (nonatomic) EDPersistence persistence;
@property (nonatomic) MFPersistenceDatabase_iOS database;
@property (nonatomic) MFMessageChangeManager_iOS messageChangeManager;
@property (nonatomic) Q protectedDataAvailability;
@property (nonatomic) BOOL allowedToAccessProtectedData;
@property (nonatomic) Q pendingIndexItemsCount;
@property (nonatomic) Q hash;
@property (nonatomic) # superclass;
@property (nonatomic) NSString description;
@property (nonatomic) NSString debugDescription;
@property (nonatomic) Q signpostID;
- (BOOL)migrate;
- (id)persistence;
- (void)invalidateAndWait;
- (void)deleteAccount:;
- (void)scheduleRecurringActivity;
- (unsigned long long)signpostID;
- (void)dealloc;
- (id)dataProvider;
- (void)addPostMigrationStep:;
- (void)willStartPersistenceDidAddMessages:;
- (void)start;
- (void)didFinishPersistenceDidAddMessages:;
- (BOOL)shouldCancel;
- (id)messageChangeManager;
- (void)persistenceDidAddMessages:generationWindow:;
- (id)groupedMessagesCountByMailboxMatchingQuery:variable:;
- (void)contentProtectionStateChanged:previousState:;
- (void)reindexAllSearchableItemsWithAcknowledgementHandler:;
- (void).cxx_destruct;
- (id)enabledAccountMailboxesExpression;
- (id)searchableIndex;
- (id)initWithPath:;
- (id)hookRegistry;
- (id)database;
- (void)test_tearDown;
- (BOOL)hasCompleteDataForMimePart:;
- (id)loadMeetingExternalIDForMessage:;
- (id)loadMeetingDataForMessage:;
- (id)loadMeetingMetadataForMessage:;
- (id)setFlagsFromDictionary:forMessages:;
- (void)setNumberOfAttachments:isSigned:isEncrypted:forMessage:;
- (void)compactMessages:;
- (id)dataPathForMessage:part:;
- (id)initWithPath:inMemoryIdentifier:userAgent:;
- (void)_setSuspendedUnderLock:;
- (id)messageBasePathForAccount:;
- (void)bodyMigrationFinished;
- (void)attachmentMigrationFinished;
- (unsigned long long)pendingIndexItemsCount;
- (void)setFlags:forMessage:;
- (void)postOldFlags:newFlags:forMessage:;
- (void)postFlagsChangedForMessages:flags:oldFlagsByMessage:;
- (void)updateFlagsForMessagesInPlace:success:;
- (id)updateFlagsForMessages:changes:transformer:;
- (void)setFlagsFromDictionary:forMessagesInMailboxURLString:;
- (void)setMessage:isPartial:;
- (BOOL)_fileType:orHigherExistsAtDirectory:;
- (void)_removeEmlxFilesOfTypeLessThanType:inDirectory:;
- (BOOL)_writeEmlxFileOfType:forAccount:toDirectory:withData:protectionClass:;
- (BOOL)_writeEmlxFile:withData:protectionClass:;
- (void)notifyNewDataAvailableForMessages:;
- (id)referencesFromHeaders:;
- (id)_addThreadingInfoWithContext:usingDatabaseConnection:;
- (BOOL)_insertThreadReferences:toMessageWithLibraryID:usingDatabaseConnection:;
- (long long)addReferenceForContext:usingDatabaseConnection:generationWindow:mergeHandler:;
- (id)duplicateMessages:newRemoteIDs:forMailbox:setFlags:createNewCacheFiles:;
- (id)duplicateMessages:newRemoteIDs:forMailbox:setFlags:clearFlags:messageFlagsForMessages:createNewCacheFiles:;
- (id)addMessages:withMailbox:newMessagesByOldMessage:remoteIDs:setFlags:addPOPUIDs:dataSectionsByMessage:generationWindow:;
- (BOOL)_addRecipients:toMessageWithDatabaseID:cache:connection:;
- (long long)_findOrCreateDatabaseIDForAddress:comment:cache:connection:;
- (long long)_findOrCreateDatabaseIDForGlobalData:cache:connection:;
- (long long)_findOrCreateDatabaseIDForSubject:cache:connection:;
- (long long)_findOrCreateDatabaseIDForSummary:cache:connection:;
- (long long)_findOrCreateDatabaseIDForValue:inTable:column:cache:connection:created:;
- (void)_removeDataFilesForGlobalID:;
- (void)updateAdditionalThreadingInfoForSentMessageWithHeaders:externalConversationID:;
- (void)updateThreadingInfoForMessage:fromHeaders:;
- (id)_selectExpressionForMessageWithAvailableTables:;
- (id)_selectClauseForOptions:protectedDataAvailable:;
- (void)_iterateStatement:connection:withProgressMonitor:andRowHandler:context:;
- (void)iterateStatement:connection:withProgressMonitor:andRowHandler:context:;
- (void)_sendMessagesForStatement:connection:to:options:timestamp:;
- (id)messagesForMailbox:limit:;
- (id)newestUIDsMissingBodyDataForMailbox:excluding:inLatest:limit:;
- (void)_enumerateMessageRemoteIDAndGlobalForMailbox:excluding:inLatest:block:;
- (id)messagesForMailbox:olderThanNumberOfDays:;
- (id)_messagesForMailbox:olderThanNumberOfDays:limit:;
- (id)serverSearchResultMessagesForMailbox:;
- (id)_firstDateForQuery:inMailbox:;
- (id)dateOfOldestNonSearchResultMessageInMailbox:;
- (id)dateOfOldestNonIndexedNonSearchResultMessageInMailbox:;
- (unsigned int)countOfRelatedMessagesMatchingCriterion:forConversationsContainingMessagesMatchingCriterion:forMailboxCriterion:;
- (unsigned long long)countMessagesMatchingCriterion:;
- (id)groupedMessagesCountForCriterion:groupBy:;
- (id)messagesWithSummariesForMailbox:range:;
- (id)orderedBatchOfMessagesEndingAtRowId:limit:success:;
- (long long)_int64ForQuery:connection:textArgument:;
- (int)_integerForQuery:withTextArgument:;
- (unsigned int)unreadCountForMailbox:matchingCriterion:;
- (unsigned int)unreadCountForAggregatedMailboxes:matchingCriterion:;
- (long long)countDistinctMessagesMatchingCriterion:;
- (unsigned int)unreadCountForAggregatedMailboxes:;
- (unsigned int)_computeUnreadCountForMailboxes:;
- (unsigned int)_flaggedCountForAggregatedMailboxes:;
- (unsigned int)_attachmentCountForAggregatedMailboxes:;
- (unsigned int)_includesMeCountForAggregatedMailboxes:;
- (unsigned int)_readLaterCountForAggregatedMailboxes:;
- (unsigned int)_sendLaterCountForAggregatedMailboxes:;
- (id)_queryForMailboxesIDsFromMailboxes:;
- (unsigned int)unreadCountForMailbox:;
- (unsigned int)flaggedCountForMailbox:;
- (unsigned int)attachmentCountForMailbox:;
- (unsigned int)includesMeCountForMailbox:;
- (unsigned int)attachmentCountForMailboxes:;
- (unsigned int)allNonDeleteCountForMailbox:includeServerSearchResults:includeThreadSearchResults:;
- (unsigned int)nonDeletedCountForMailbox:includeServerSearchResults:includeThreadSearchResults:;
- (unsigned int)nonDeletedCountForMailbox:;
- (unsigned int)nonDeletedCountForAggregatedMailboxes:includeServerSearchResults:includeThreadSearchResults:;
- (unsigned int)nonDeletedCountForAggregatedMailboxes:;
- (unsigned int)totalCountForMailbox:;
- (unsigned long long)serverUnreadOnlyOnServerCountForMailbox:;
- (unsigned long long)indexedCountForMailbox:limit:;
- (void)setServerUnreadOnlyOnServerCount:forMailbox:;
- (void)setLastSyncAndMostRecentStatusCount:forMailbox:;
- (void)increaseProtectionOnFileForMessage:;
- (unsigned long long)mostRecentStatusCountForMailbox:;
- (void)setMostRecentStatusCount:forMailbox:;
- (id)messageWithRemoteID:inRemoteMailbox:;
- (id)copyMessagesWithRemoteIDs:options:inRemoteMailbox:;
- (id)sequenceIdentifierForMailbox:;
- (void)setSequenceIdentifier:forMailbox:;
- (id)sequenceIdentifierForMessagesWithRemoteIDs:inMailbox:;
- (void)setSequenceIdentifier:forMessageWithLibraryID:;
- (void)setSequenceIdentifier:forMessagesWithRemoteIDs:inMailbox:;
- (id)messageWithMessageID:options:inMailbox:;
- (id)messagesWithMessageIDHeader:;
- (id)_keyForOptions:protectedDataAvailable:mailboxAvailable:mailboxCached:;
- (id)messageWithLibraryID:options:inMailbox:;
- (id)messageWithLibraryID:options:inMailbox:temporarilyUnavailable:;
- (id)conversationIDsOfMessagesInSameThreadAsMessageWithLibraryID:messageIDHash:;
- (id)_copyReferenceHashesWithoutMessagesForMessageWithConversation:;
- (id)_getReferencesForHashesWithOwners:;
- (long long)loadMoreMessagesForThreadContainingMessage:hasNoMoreMessages:;
- (id)stringForQuery:monitor:;
- (id)stringForQuery:;
- (void)reloadMailboxCacheIfNecessaryWithConnection:;
- (void)reloadMailboxCacheWithConnection:;
- (id)urlForMailboxID:;
- (id)mailboxURLsForIDs:;
- (long long)mailboxIDForURLString:createIfNecessary:;
- (long long)mailboxIDForURLString:;
- (id)mailboxURLForMessage:;
- (id)mailboxUidForMessage:;
- (id)remoteStoreForMessage:;
- (id)accountForMessage:;
- (BOOL)_canSelectMessagesWithOptions:connection:;
- (void)clearServerSearchFlagsForMessagesWithLibraryIDs:;
- (unsigned long long)flagsForConversationId:;
- (void)setFlags:forConversationId:;
- (void)setConversationInfo:syncKey:flags:;
- (long long)_conversationIdForMessageIds:;
- (id)storedIntegerPropertyWithName:;
- (void)setStoredIntegerPropertyWithName:value:;
- (void)_notifyDidCompact:messages:mailboxes:;
- (void)compactMessages:permanently:;
- (BOOL)_deleteMessages:connection:;
- (BOOL)_addAddressesFromRecipientsForMessages:toSet:connection:;
- (BOOL)_deleteMessages:andCleanUpAddresses:subjects:summaries:brandIndicators:connection:;
- (void)_removeGlobalDataForMessagesIfNecessary:connection:;
- (id)_existingValuesForColumn:table:fromValues:connection:;
- (long long)_maxRowIDInSet:;
- (BOOL)_deleteRows:fromTable:connection:;
- (void)compactMailbox:;
- (BOOL)renameMailboxes:to:;
- (void)deleteMailboxes:account:;
- (void)removeAllMessagesFromMailbox:removeMailbox:andNotify:;
- (id)dataPathForMessage:type:;
- (id)dataPathForMessage:;
- (long long)deleteAttachmentsForMessage:inMailboxFileURL:;
- (id)fileAttributesForMessage:;
- (void)fileURLForAttachmentPersistentID:messageID:result:;
- (id)dataConsumerForMessage:part:;
- (id)dataConsumerForMessage:part:incomplete:;
- (id)dataConsumerForMessage:isPartial:;
- (id)dataConsumerForMessage:;
- (void)setData:forMessage:isPartial:;
- (void)setData:forMessageToAppend:;
- (BOOL)_setMessageData:libraryID:part:partial:complete:connection:;
- (void)setSummary:forMessage:;
- (BOOL)_setSummary:forMessageWithRowID:connection:;
- (id)loadData:forMessage:usingBlock:;
- (id)bodyDataAtPath:headerData:;
- (id)headerDataAtPath:;
- (id)bodyDataForMessage:andHeaderDataIfReadilyAvailable:;
- (id)bodyDataForMessage:andHeaderDataIfReadilyAvailable:isComplete:;
- (id)bodyDataForMessage:;
- (id)headerDataForMessage:;
- (id)fullBodyDataForMessage:andHeaderDataIfReadilyAvailable:;
- (id)dataForMimePart:isComplete:;
- (BOOL)areMessageContentsLocallyAvailable:fullContentsAvailble:;
- (id)_equalToMailboxIDsFromCriterion:;
- (id)_sqlSortByStringFromOptions:;
- (id)queryForCriterion:connection:options:baseTable:isSubquery:range:;
- (id)queryForCriterion:connection:options:baseTable:isSubquery:;
- (id)queryForCriterion:connection:options:baseTable:;
- (id)queryForCriterion:connection:options:range:;
- (id)queryForCriterion:connection:options:;
- (void)sendMessagesMatchingCriterion:to:options:baseTable:range:success:;
- (void)sendMessagesMatchingCriterion:to:options:baseTable:range:;
- (void)sendMessagesMatchingCriterion:to:options:baseTable:;
- (void)sendMessagesMatchingCriterion:to:options:range:;
- (void)sendMessagesMatchingCriterion:to:options:;
- (id)sqlQueryWithConversionLogForQuery:;
- (void)iterateMessagesMatchingQuery:byConvertingToCriteria:queryTransformer:withResultHandler:options:withMonitor:;
- (void)_iterateMessagesWithResultHandler:options:monitor:sqlQueryGenerator:;
- (id)_sqlQueryForQuery:byConvertingToCriteria:queryTransformer:connection:options:;
- (id)queriesSeparatedByMailboxForQuery:;
- (id)_predicatesSeparatedByMailboxForPredicate:containsMailboxPredicate:;
- (id)_predicatesSeparatedByMailboxForAndPredicate:containsMailboxPredicate:;
- (id)_predicatesSeparatedByMailboxForOrPredicate:containsMailboxPredicate:;
- (id)queryParser;
- (void)iterateMessagesMatchingCriterion:withResultHandler:options:withMonitor:;
- (void)iterateMessagesMatchingCriterion:options:handler:;
- (id)messagesMatchingCriterion:options:range:;
- (id)messagesMatchingCriterion:options:range:success:;
- (id)messagesMatchingCriterion:options:success:;
- (id)messagesMatchingCriterion:options:;
- (id)filterContiguousMessages:forCriterion:options:;
- (void)invalidateAccount:;
- (id)_mailboxesClauseForAccounts:;
- (void)prepareToRebuildActiveAccountsClausesAndExpressions;
- (void)rebuildActiveAccountsClausesAndExpressionsWithAccounts:;
- (void)rebuildActiveAccountMailboxesExpression:;
- (void)rebuildActiveAccountsClauseWithActiveAccounts:inactiveAccounts:;
- (id)_activeAccountsClause;
- (id)_nonLocalAccountsClause;
- (void)_waitForActiveAccountsRebuild;
- (void)deletePOPUID:inMailbox:;
- (id)UIDsToDeleteInMailbox:;
- (id)allUIDsInMailbox:;
- (id)hiddenPOPUIDsInMailbox:;
- (void)_setProtectedDataAvailabilityState:;
- (unsigned long long)protectedDataAvailability;
- (id)_indexSetOfMessagesDeleted;
- (BOOL)cleanupProtectedTables;
- (BOOL)_shouldLogDatabaseStats;
- (void)_logStatistics;
- (void)_schedulePeriodicStatisticsLogging;
- (BOOL)isProtectedDataAvailable:;
- (void)_scheduleJournalReconciliation;
- (void)_cancelPendingJournalReconciliation;
- (BOOL)_canAccessProtectedData;
- (void)journalWasReconciled;
- (void)_addMessageToThreadAtUnlock:;
- (void)performIncrementalVacuumForSchema:;
- (void)_scheduleIncrementalVacuum;
- (void)closeDatabaseConnections;
- (void)journalReconciliationFailed;
- (void)handleFailedMigration;
- (void)renameOrRemoveDatabaseIfNeeded;
- (id)_stringsForIndexSet:;
- (id)indexableMessagesWhere:sortedBy:limit:options:;
- (void)removeSearchableItemsForAccount:;
- (void)removeSearchableItemsForMailbox:;
- (void)removeSearchableItemsForMessages:;
- (void)removeSearchableItemsForAccount:mailboxID:;
- (void)_removeSearchableItemsWithLibraryIDs:;
- (void)reindexSearchableItemsWithIdentifiers:acknowledgementHandler:;
- (void)removeMessagesFromCacheWithLibraryIDs:;
- (id)_libraryMessageCache;
- (id)_libraryMessageWithLibraryID:wasCached:;
- (id)_messageForRow:options:timestamp:connection:isProtectedDataAvailable:recipientsCache:;
- (id)_recipientsForMessageWithDatabaseID:connection:recipientsCache:;
- (id)_recipientsForMessagesWithDatabaseIDs:includeTo:includeCC:includeBCC:;
- (id)stringFromAllMailboxUnreadCount;
- (BOOL)messageDataExistsInDatabaseForMessageLibraryID:part:length:;
- (id)remoteContentParser;
- (BOOL)_shouldStoreRemoteContentForMessage:;
- (BOOL)_storeRemoteContentLinksCachedOnMessage:linksToVerify:;
- (void)storeRemoteContentLinksFromFullData:forMessage:;
- (void)_processMessageData:forMessage:linksToVerify:parsingOptions:;
- (void)storeRemoteContentLinksFromHeaderData:bodyData:forMessage:;
- (void)_findHTMLPartsFromHeaderData:bodyData:forMessage:linksToVerify:parsingOptions:;
- (void)storeRemoteContentLinksFromData:forMessage:mimePart:;
- (void)_processRemoteContentFromData:forMimePart:linksToVerify:forMessage:parsingOptions:;
- (BOOL)_shouldPerformDataDetectionForMessage:;
- (void)detectDataFromPlainTextMessage:globalMessageID:mimePart:;
- (id)_getHTMLFromPlainTextData:mimePart:;
- (BOOL)allowedToAccessProtectedData;
- (id)searchableIndexScheduler;
- (void)setSearchableIndexScheduler:;
- (void)setQueryParser:;
- (id)fileRemovalAfterCompactionScheduler;
- (void)setFileRemovalAfterCompactionScheduler:;
- (id)currentAddedMessagesMap;
- (void)setCurrentAddedMessagesMap:;
- (id)bodyMigrator;
- (void)setBodyMigrator:;
- (id)stateCaptureCancelable;
- (id)messagesParsedCache;
- (id)attachmentMigrator;
- (void)setAttachmentMigrator:;
+ (id)log;
+ (void)test_setDefaultInstance:;
+ (BOOL)canUsePersistence;
+ (id)propertyMapper;
+ (id)defaultPath;
+ (void)_renameLibraryAtPath:;
+ (id)signpostLog;
+ (void)removeLibraryOnNextLaunch;
+ (id)defaultInstance;
@end
